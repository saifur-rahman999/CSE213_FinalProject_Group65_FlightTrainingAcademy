<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.*?>

<AnchorPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.example.cse213_finalproject_group65_flighttrainingacademy.TrainingRecordsOfficer.TRODashBoard"
            prefHeight="720.0" prefWidth="1180.0">

    <!-- Use a BorderPane to structure the dashboard -->
    <children>
        <BorderPane prefHeight="720.0" prefWidth="1180.0" AnchorPane.topAnchor="0.0" AnchorPane.bottomAnchor="0.0" AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0">
            <!-- TOP: App header -->
            <top>
                <HBox spacing="16.0" style="-fx-background-color: #0f172a; -fx-padding: 12 16;" alignment="CENTER_LEFT">
                    <children>
                        <Label text="✈ Flight Training Academy • TRO Dashboard"
                               style="-fx-text-fill: white; -fx-font-size: 16px; -fx-font-weight: bold;"/>
                        <Pane HBox.hgrow="ALWAYS"/>
                        <TextField fx:id="globalSearchField"
                                   promptText="Search trainees, flights, certificates…"
                                   prefWidth="360.0"/>
                        <Button text="Search" onAction="#onGlobalSearch" />
                        <Separator orientation="VERTICAL" prefHeight="24.0"/>
                        <MenuButton text="Account">
                            <items>
                                <MenuItem text="Profile" onAction="#onOpenProfile"/>
                                <MenuItem text="Settings" onAction="#onOpenSettings"/>
                                <SeparatorMenuItem/>
                                <MenuItem text="Sign out" onAction="#onSignOut"/>
                            </items>
                        </MenuButton>
                    </children>
                </HBox>
            </top>

            <!-- LEFT: Sidebar navigation -->
            <left>
                <VBox spacing="6.0" prefWidth="230.0" style="-fx-background-color: #f8fafc; -fx-padding: 12;">
                    <fx:define>
                        <ToggleGroup fx:id="navToggleGroup"/>
                    </fx:define>
                    <children>
                        <Label text="Navigation" style="-fx-font-weight: bold; -fx-text-fill:#0f172a; -fx-padding: 6 4;"/>
                        <ToggleButton text="Overview" toggleGroup="$navToggleGroup" selected="true" onAction="#onNavOverview"/>
                        <ToggleButton text="Trainee Records" toggleGroup="$navToggleGroup" onAction="#onNavTrainees"/>
                        <ToggleButton text="Flights / Sessions" toggleGroup="$navToggleGroup" onAction="#onNavFlights"/>
                        <ToggleButton text="Certificates" toggleGroup="$navToggleGroup" onAction="#onNavCertificates"/>
                        <ToggleButton text="Instructors" toggleGroup="$navToggleGroup" onAction="#onNavInstructors"/>
                        <ToggleButton text="Reports" toggleGroup="$navToggleGroup" onAction="#onNavReports"/>
                        <Region VBox.vgrow="ALWAYS"/>
                        <Button text="Backup Data" onAction="#onBackupData"/>
                        <Button text="Restore Data" onAction="#onRestoreData"/>
                    </children>
                </VBox>
            </left>

            <!-- CENTER: Main workspace -->
            <center>
                <VBox spacing="12.0" style="-fx-padding: 12;">
                    <!-- Filter bar -->
                    <HBox spacing="10.0" alignment="CENTER_LEFT">
                        <children>
                            <Label text="Filters:" style="-fx-font-weight: bold;"/>
                            <ComboBox fx:id="statusFilterCombo" promptText="Training Status" prefWidth="160.0"/>
                            <ComboBox fx:id="licenseFilterCombo" promptText="License Type" prefWidth="160.0"/>
                            <DatePicker fx:id="fromDatePicker" promptText="From date"/>
                            <DatePicker fx:id="toDatePicker" promptText="To date"/>
                            <Button text="Apply" onAction="#onApplyFilters"/>
                            <Button text="Reset" onAction="#onResetFilters"/>
                            <Pane HBox.hgrow="ALWAYS"/>
                            <Button text="New Record" onAction="#onNewRecord" style="-fx-font-weight: bold;"/>
                        </children>
                    </HBox>

                    <!-- Quick KPIs -->
                    <HBox spacing="12.0">
                        <children>
                            <HBox spacing="8.0" style="-fx-background-color:#eef2ff; -fx-padding:10; -fx-background-radius:8;" alignment="CENTER_LEFT">
                                <children>
                                    <ImageView fitHeight="28.0" fitWidth="28.0"/>
                                    <VBox>
                                        <children>
                                            <Label text="Active Trainees" style="-fx-font-size:11px; -fx-text-fill:#334155;"/>
                                            <Label fx:id="activeTraineesLabel" text="0" style="-fx-font-size:18px; -fx-font-weight:bold;"/>
                                        </children>
                                    </VBox>
                                </children>
                            </HBox>
                            <HBox spacing="8.0" style="-fx-background-color:#ecfeff; -fx-padding:10; -fx-background-radius:8;" alignment="CENTER_LEFT">
                                <children>
                                    <ImageView fitHeight="28.0" fitWidth="28.0"/>
                                    <VBox>
                                        <children>
                                            <Label text="Flights This Month" style="-fx-font-size:11px; -fx-text-fill:#334155;"/>
                                            <Label fx:id="flightsThisMonthLabel" text="0" style="-fx-font-size:18px; -fx-font-weight:bold;"/>
                                        </children>
                                    </VBox>
                                </children>
                            </HBox>
                            <HBox spacing="8.0" style="-fx-background-color:#f0fdf4; -fx-padding:10; -fx-background-radius:8;" alignment="CENTER_LEFT">
                                <children>
                                    <ImageView fitHeight="28.0" fitWidth="28.0"/>
                                    <VBox>
                                        <children>
                                            <Label text="Certificates Due" style="-fx-font-size:11px; -fx-text-fill:#334155;"/>
                                            <Label fx:id="certsDueLabel" text="0" style="-fx-font-size:18px; -fx-font-weight:bold;"/>
                                        </children>
                                    </VBox>
                                </children>
                            </HBox>
                        </children>
                    </HBox>

                    <!-- Tabs: Overview charts + Records table -->
                    <TabPane fx:id="mainTabPane">
                        <tabs>
                            <Tab text="Overview" closable="false">
                                <content>
                                    <HBox spacing="12.0" style="-fx-padding: 8;">
                                        <children>
                                            <PieChart fx:id="statusPieChart" title="Trainee Status Distribution" prefWidth="420.0"/>
                                            <BarChart fx:id="hoursBarChart" title="Monthly Flight Hours"
                                                      prefWidth="520.0">
                                                <xAxis>
                                                    <CategoryAxis label="Month"/>
                                                </xAxis>
                                                <yAxis>
                                                    <NumberAxis label="Hours"/>
                                                </yAxis>
                                            </BarChart>
                                        </children>
                                    </HBox>
                                </content>
                            </Tab>
                            <Tab text="Records" closable="false">
                                <content>
                                    <VBox spacing="8.0" style="-fx-padding: 8;">
                                        <children>
                                            <!-- Action bar -->
                                            <HBox spacing="8.0">
                                                <children>
                                                    <Button text="Edit" onAction="#onEditSelected"/>
                                                    <Button text="Delete" onAction="#onDeleteSelected"/>
                                                    <Button text="Refresh" onAction="#onRefreshTable"/>
                                                    <Pane HBox.hgrow="ALWAYS"/>
                                                    <Button text="Export CSV" onAction="#onExportCsv"/>
                                                    <Button text="Export PDF" onAction="#onExportPdf"/>
                                                </children>
                                            </HBox>

                                            <!-- Table -->
                                            <TableView fx:id="traineeTable" prefHeight="420.0">
                                                <columns>
                                                    <TableColumn fx:id="idCol" text="ID" prefWidth="90.0"/>
                                                    <TableColumn fx:id="nameCol" text="Name" prefWidth="180.0"/>
                                                    <TableColumn fx:id="licenseCol" text="License" prefWidth="120.0"/>
                                                    <TableColumn fx:id="hoursCol" text="Flight Hours" prefWidth="120.0"/>
                                                    <TableColumn fx:id="lastFlightCol" text="Last Flight" prefWidth="140.0"/>
                                                    <TableColumn fx:id="statusCol" text="Status" prefWidth="120.0"/>
                                                </columns>
                                            </TableView>
                                        </children>
                                    </VBox>
                                </content>
                            </Tab>
                        </tabs>
                    </TabPane>
                </VBox>
            </center>

            <!-- BOTTOM: Status bar -->
            <bottom>
                <HBox spacing="12.0" alignment="CENTER_LEFT" style="-fx-background-color:#f1f5f9; -fx-padding: 8 12;">
                    <children>
                        <Label fx:id="statusBarLabel" text="Ready."/>
                        <Pane HBox.hgrow="ALWAYS"/>
                        <ProgressIndicator fx:id="busyIndicator" prefWidth="22.0" prefHeight="22.0" visible="false"/>
                    </children>
                </HBox>
            </bottom>
        </BorderPane>
    </children>

    <!-- Padding for the root AnchorPane (optional visual breathing room) -->
    <padding>
        <Insets top="0" right="0" bottom="0" left="0"/>
    </padding>
</AnchorPane>
